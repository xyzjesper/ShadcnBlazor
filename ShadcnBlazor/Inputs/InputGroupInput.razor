@inherits ShadcnBase

@if (Slot != null)
{
    <InputField @attributes="Attributes" Context="inputFieldAttrs">
        <Slot>
            @Slot.Invoke(inputFieldAttrs)
        </Slot>
    </InputField>
}
else
{
    <InputField @bind-Value="Value" @attributes="Attributes" />
}

@code
{
    [Parameter]
    public string Value
    {
        get => _value;
        set
        {
            if (_value == value) return;

            _value = value;
            ValueChanged.InvokeAsync(value);
        }
    }

    [Parameter]
    public EventCallback<string> ValueChanged { get; set; }

    private string _value;
    
    [Parameter] public RenderFragment ChildContent { get; set; }
    [Parameter] public RenderFragment<Dictionary<string, object?>>? Slot { get; set; }

    private Dictionary<string, object?> Attributes;

    protected override void OnParametersSet()
    {
        Attributes = new();
        
        Attributes["ClassName"] = Cn(
            "flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent",
            ClassName
        );
        
        if(Props == null)
            return;

        foreach (var prop in Props)
            Attributes[prop.Key] = prop.Value;
    }
}