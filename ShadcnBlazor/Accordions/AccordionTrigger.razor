@inherits ShadcnBase

<h3 data-orientation="vertical" data-state="@(Item.IsOpen ? "open" : "closed")" class="flex">
    <button @onclick="TriggerAsync"
            type="button"
            aria-expanded="false"
            data-state="@(Item.IsOpen ? "open" : "closed")"
            data-orientation="vertical"
            data-slot="accordion-trigger"
            class="@Classes"
            @attributes="Props">
        @ChildContent
        
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down-icon lucide-chevron-down text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"><path d="m6 9 6 6 6-6"/></svg>
    </button>
</h3>

@code
{
    [CascadingParameter(Name = "AccordionItem")]
    public AccordionItem Item { get; set; }

    [CascadingParameter(Name = "Accordion")]
    public Accordion Accordion { get; set; }

    [Parameter] public RenderFragment ChildContent { get; set; }

    private string? Classes;

    protected override void OnParametersSet()
    {
        Classes = Cn(
            "focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",
            "hover:cursor-pointer",
            ClassName
        );
    }

    private async Task TriggerAsync()
        => await Accordion.TriggerAsync(Item.Value);
}
